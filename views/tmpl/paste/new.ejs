<div class="file">
  <div class="header">
    <label for="file[0]">Filename:</label><input type="text" name="file[0][name]" id="file[0]" class="shrFilename" style="width: 80%"/>
    <select name="file[0][lang]" style="float: right">
        <option value="none">plain text</option>
        <option value="php">PHP</<option>
        <option value="cpp">C++</<option>
    </select>
  </div>
  <textarea name="file[0][content]" style="width:100%;padding:0;min-height:300px;"></textarea>
</div>

<a href="#" id="addFile">&plus; File</a>

<script type="text/javascript">
$(function() { 
    $('#addFile').click(function(evt) { 
        var c = $('.file').length;
        var n = $('.file:first').clone().insertBefore(this).css('display', 'none');
        $('input', n).val('');
        $('input, select, textarea', n).each(function() {
            var nName = $(this).attr('name').replace(/\[\d\]/, '[' + c + ']');
            $(this).attr('name', nName);
        });
        $(n).slideDown();
        evt.preventDefault();
    });
});
</script>
